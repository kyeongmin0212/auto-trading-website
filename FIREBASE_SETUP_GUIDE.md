# Firebase 서비스 계정 키 설정 가이드

## 개요
자동매매 코드가 웹사이트 설정을 실시간으로 반영하려면 Firebase 서비스 계정 키가 필요합니다.

## 1. Firebase 서비스 계정 키 생성

### 1.1 Firebase 콘솔 접속
1. [Firebase Console](https://console.firebase.google.com/)에 접속
2. 프로젝트 선택

### 1.2 서비스 계정 설정
1. 왼쪽 메뉴에서 **프로젝트 설정** (⚙️ 아이콘) 클릭
2. **서비스 계정** 탭 선택
3. **새 비공개 키 생성** 버튼 클릭
4. JSON 파일 다운로드

### 1.3 파일 배치
1. 다운로드된 JSON 파일을 프로젝트 루트 디렉토리에 배치
2. 파일명을 `firebase-service-account.json`으로 변경

## 2. 환경 변수 설정

### 2.1 사용자 이메일 설정
`.env` 파일에 사용자 이메일을 추가:

```env
USER_EMAIL=your-email@example.com
```

### 2.2 자동매매 활성화
웹사이트에서 자동매매를 활성화하면 `isActive` 필드가 `true`로 설정됩니다.

## 3. 작동 방식

### 3.1 설정 로드 순서
1. **Firebase 우선**: 웹사이트에서 설정한 값
2. **환경변수 백업**: `.env` 파일의 값

### 3.2 실시간 업데이트
- **5분마다** Firebase에서 최신 설정 확인
- 설정 변경 시 자동으로 봇 재초기화
- 웹사이트에서 설정 변경 시 즉시 반영

### 3.3 지원하는 설정들
- API 키 (Telegram, OpenAI, KIS)
- 거래 설정 (손절, 익절, DCA 등)
- 기술적 지표 설정 (RSI, MACD, Bollinger Bands)
- 거래 시간 설정
- 자동매매 활성화/비활성화

## 4. 문제 해결

### 4.1 Firebase 연결 실패
- 서비스 계정 키 파일이 올바른 위치에 있는지 확인
- 파일 권한 확인
- 인터넷 연결 상태 확인

### 4.2 설정이 반영되지 않음
- 웹사이트에서 설정 저장 후 자동매매 활성화 확인
- 로그에서 "Firebase 설정을 사용합니다" 메시지 확인
- 5분 대기 후 자동 업데이트 확인

## 5. 보안 주의사항

### 5.1 서비스 계정 키 보호
- `firebase-service-account.json` 파일을 Git에 커밋하지 마세요
- `.gitignore`에 추가되어 있는지 확인
- 파일 접근 권한을 제한하세요

### 5.2 환경 변수 보호
- `.env` 파일도 Git에 커밋하지 마세요
- API 키가 노출되지 않도록 주의하세요

## 6. 테스트

### 6.1 설정 변경 테스트
1. 웹사이트에서 설정 변경
2. 자동매매 활성화
3. 로그에서 "설정이 성공적으로 업데이트되었습니다" 메시지 확인
4. 변경된 설정으로 자동매매 실행 확인

### 6.2 실시간 반영 테스트
1. 웹사이트에서 설정 변경
2. 5분 이내에 자동매매 코드에서 변경된 값 확인
3. 로그에서 업데이트 과정 모니터링
